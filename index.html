<?php
// config.php - API Ayarları
$apiKey = "senin_pterodactyl_application_api_keyin";
$panelUrl = "https://panel.seninsiten.com";

// Kullanıcı butona bastığında çalışacak fonksiyon
function createServer($userId, $serverName) {
    global $apiKey, $panelUrl;

    $data = [
        "name" => $serverName,
        "user" => $userId, // Pterodactyl'deki kullanıcı ID'si
        "nest" => 1, // Minecraft Nest ID
        "egg" => 5, // Playit destekli Egg ID
        "docker_image" => "ghcr.io/pterodactyl/yolks:java_17",
        "startup" => "java -Xms128M -Xmx{{SERVER_MEMORY}}M -jar server.jar",
        "environment" => [
            "SERVER_JARFILE" => "server.jar",
            "BUILD_NUMBER" => "latest"
        ],
        "limits" => [
            "memory" => 1024, // 1 GB RAM
            "swap" => 0,
            "disk" => 5000, // 5 GB Disk
            "io" => 500,
            "cpu" => 100 // %100 CPU
        ],
        "feature_limits" => [
            "databases" => 0,
            "backups" => 0
        ]
    ];

    $ch = curl_init($panelUrl . "/api/application/servers");
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, [
        "Authorization: Bearer " . $apiKey,
        "Content-Type: application/json",
        "Accept: Application/vnd.pterodactyl.v1+json"
    ]);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($data));

    $response = curl_exec($ch);
    curl_close($ch);

    return $response; // Başarılıysa sunucu oluştu demektir!
}
?>
